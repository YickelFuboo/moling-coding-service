# RAG/Res 模块调用关系文档

## 概述

ag/res 模块是RAGFlow项目中的资源文件目录，包含NLP处理所需的各种词典和配置文件。这些资源文件为文本处理、分词、同义词扩展、命名实体识别等功能提供基础数据支持。

## 资源文件调用关系表

| 资源文件 | 被调用的外部文件 | 文件大小 | 用途说明 |
|---------|----------------|---------|----------|
| synonym.json | rag/nlp/synonym.py | 262KB | 同义词词典，用于查询扩展和同义词替换 |
| ner.json | rag/nlp/term_weight.py | 230KB | 命名实体识别词典，用于实体类型标注 |
| huqie.txt | rag/nlp/rag_tokenizer.py | 7.9MB | 胡切词典，用于中文分词和词频统计 |

## 详细调用关系

### synonym.json
- **调用模块**: ag/nlp/synonym.py - 同义词处理模块
- **调用方式**: 通过 json.load() 加载词典数据
- **使用场景**: 查询扩展、同义词替换、语义搜索增强
- **数据格式**: JSON格式，键值对映射同义词关系

### ner.json
- **调用模块**: ag/nlp/term_weight.py - 词权重计算模块
- **调用方式**: 通过 json.load() 加载实体词典
- **使用场景**: 命名实体识别、实体类型标注、词权重计算
- **数据格式**: JSON格式，实体名称到实体类型的映射

### huqie.txt
- **调用模块**: ag/nlp/rag_tokenizer.py - 分词器模块
- **调用方式**: 构建Trie树结构进行高效分词
- **使用场景**: 中文分词、词频统计、分词优化
- **数据格式**: 文本格式，每行包含：词汇 词频 词性
- **特殊处理**: 自动生成 .trie 缓存文件提高加载速度

## 资源文件管理

### 加载机制
- 所有资源文件在模块初始化时加载
- 支持异常处理，缺失文件时使用默认配置
- huqie.txt 支持缓存机制，提高重复加载性能

### 文件来源
- **synonym.json**: 项目内置同义词词典
- **ner.json**: 项目内置命名实体词典
- **huqie.txt**: 从HuggingFace下载的胡切词典

### 注意事项
- 资源文件较大，首次加载可能较慢
- huqie.txt 会自动生成缓存文件，请确保有写入权限
- 修改资源文件后需要重启相关服务才能生效
